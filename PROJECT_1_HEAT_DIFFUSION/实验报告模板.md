# 项目：铝棒热传导方程显式差分法数值解 - 实验报告

**学生姓名：** 陈南

**学号：** 20231050035

**完成日期：** 25.6.11

## 1. 实验目的

通过实现显式差分法求解一维热传导方程，掌握偏微分方程数值解法的基本原理，深入理解显式差分法的稳定性条件和精度特点，学会分析数值方法的误差和稳定性。

## 2. 理论背景

### 2.1 热传导方程

一维热传导方程的数学表达式为：

$$\frac{\partial T(x,t)}{\partial t} = \alpha \frac{\partial^2 T(x,t)}{\partial x^2}$$

其中：
- $T(x,t)$ 是温度分布函数
- $\alpha = \frac{K}{C\rho}$ 是热扩散系数
- $K$ 是热导率， $C$ 是比热容， $\rho$ 是密度

### 2.2 边界条件和初始条件

- **边界条件：** $T(0,t) = T(L,t) = 0$ K（两端保持0度）
- **初始条件：** $T(x,0) = 100$ K（初始温度均匀分布）

### 2.3 解析解

该问题的解析解为傅里叶级数：

$$T(x,t) = \sum_{n=1,3,5,\ldots}^{\infty} \frac{4T_0}{n\pi} \sin(k_n x) e^{-k_n^2 \alpha t}$$

其中 $k_n = \frac{n\pi}{L}$， $T_0 = 100$ K。

## 2. 核心算法

### 2.1 显式差分法算法思路

显式差分法是一种求解热传导方程等偏微分方程的数值方法，其基本思想是将时间和空间变量离散化，并使用当前时刻已知的温度值显式计算下一时刻的温度。在一维热传导问题中，显式差分法将时间导数用前向差分、空间二阶导数用中心差分近似，从而得到数值格式：$u_i^{n+1} = u_i^n + r (u_{i+1}^n - 2u_i^n + u_{i-1}^n)$，其中 $r = D\Delta t/\Delta x^2$ 是稳定性因子。该方法优点是结构简单、计算效率高，但数值稳定性受限较大，必须满足稳定性条件 $r \leq 1/2$，否则数值解会出现震荡甚至发散。因此，在使用显式差分法时需合理选择时间步长和空间步长以确保计算结果的可靠性。


### 2.2 关键代码片段
```python
# 显式差分法核心代码
# 插入你认为的关键代码段
u = np.zeros((Nx, Nt))             # 创建温度数组
u[:, 0] = np.sin(np.pi * x)        # 初始条件（例如：正弦分布）
r = D * dt / dx**2                 # 稳定性因子

for n in range(0, Nt - 1):
    u[1:-1, n+1] = u[1:-1, n] + r * (u[2:, n] - 2 * u[1:-1, n] + u[:-2, n])

```

## 3. 实验结果

### 3.1 显式差分法数值解

![image](https://github.com/user-attachments/assets/16e65c3a-bb75-4226-9f8e-48a0c10aa996)

### 3.2 解析解
**解析解公式：**

$$T(x,t)=\sum\limits_{n=1,3,\cdots}^{\infty}\frac{4T_0}{n\pi}\sin(k_nx)e^{-k_n^2Dt}$$

其中 $k_n = n\pi/L$， $T_0=100$ K

![image](https://github.com/user-attachments/assets/3f2a43b2-dc0a-4eca-a20f-ce3a973f0267)

### 3.3 稳定性分析

**稳定性条件：** r = DΔt/Δx² ≤ 0.5

分析不同 $r$ 值下的数值解行为，展示稳定和不稳定情况的对比

![image](https://github.com/user-attachments/assets/8a1ba4c6-d3c4-42d4-8e6e-2b1641592051)

![image](https://github.com/user-attachments/assets/c1d9bd7c-46f6-4bd9-ad6f-2ae191610d8d)

### 3.4 不同初始条件模拟

![image](https://github.com/user-attachments/assets/e256038e-9421-4280-9ccd-1da9a873f423)


### 3.5 包含牛顿冷却定律的模拟
![image](https://github.com/user-attachments/assets/90dba18e-93e8-4132-8526-e0d9cd3e5a75)

## 4. 分析与讨论

1. **稳定性问题：** 在实现显式差分法求解热传导方程的过程中，会遇到一个显著的**稳定性问题**。该方法对时间步长和空间步长的选择非常敏感，必须满足**稳定性条件** $r = \frac{D \cdot \Delta t}{\Delta x^2} \leq \frac{1}{2}$，否则数值解将变得不稳定。当 $r > 0.5$ 时，温度值会随着时间迅速发散，表现为非物理性的剧烈震荡甚至“爆炸”，即温度值超过合理范围。初学者在调试中往往会因为设置了过大的时间步长 $\Delta t$，导致结果不收敛或图像异常。因此，为了确保模拟稳定可靠，必须仔细选择合适的 $\Delta t$ 和 $\Delta x$，或考虑使用稳定性更强的隐式差分或Crank-Nicolson方法。

2. **精度问题：** 在使用显式差分法求解热传导问题时，除了稳定性问题，还存在**精度相关的困难**。该方法的时间和空间离散近似分别是**一阶和二阶精度**，因此误差随时间累计，长时间模拟可能会导致结果偏离真实解。同时，为了保证稳定性，常常需要选取非常小的时间步长 $\Delta t$，这虽然能提高稳定性，但会显著增加计算量，从而降低效率。此外，当问题的解随时间或空间剧烈变化时，固定的网格精度可能不足以捕捉这些变化，导致数值扩散或失真。

为提升精度，可采取以下改进方法：

1. **减小空间步长 $\Delta x$**：提高空间解析能力，但需相应减小时间步长以维持稳定性；
2. **使用高阶差分格式**：如四阶空间差分，能在同样网格下提高精度；
3. **改用Crank-Nicolson方法**：该方法结合了显式和隐式方法，具有二阶时间精度和稳定性，适合更高精度的模拟；
4. **采用自适应网格与时间步长**：根据解的变化动态调整离散精度，以提高效率与精度兼顾。

综上，显式差分法虽然易于实现，但在追求高精度模拟时需要谨慎处理，并考虑引入更稳定、精度更高的改进策略。


## 5. 思考题

### 5.1 理论思考

1. **为什么显式差分法在r > 0.5时会产生数值振荡？**
  显式差分法在 $r = \frac{D \cdot \Delta t}{\Delta x^2} > 0.5$ 时会产生数值振荡，是因为该方法在迭代过程中会放大数值误差。当 $r$ 超过 0.5 时，通过傅里叶（Von Neumann）稳定性分析可以发现，某些高频误差分量的放大因子大于 1，这意味着初始误差或舍入误差会在迭代中被不断放大，导致解出现非物理性的剧烈波动甚至发散。尤其在高频扰动存在的情况下，这种放大效应会迅速累积，最终使温度分布失真。因此，显式差分法是条件稳定的，必须严格满足 $r \leq 0.5$ 才能确保数值解的稳定性和可信度。


2. **如何从物理角度理解稳定性条件的含义？**
   从**物理角度**来看，显式差分法的稳定性条件 $r = \frac{D \cdot \Delta t}{\Delta x^2} \leq 0.5$ 表示：**在每个时间步内，热量的传播范围不能超过相邻网格点的距离**。热扩散是一个缓慢、连续的过程，真实物理中热量在短时间内只能在局部范围内平滑传播。然而如果数值模拟中选用了过大的时间步长 $\Delta t$，就等于假设热量在一个时间步内“跳跃”太远，远远超出物理上允许的扩散速度，这种不合理的假设会导致能量在数值计算中剧烈波动，从而出现震荡和发散。因此，稳定性条件实际上限制了每个时间步内的“热扩散步长”，确保热量以符合物理规律的方式逐步扩散，避免非物理性的热量瞬间传输或累积失控。这个条件本质上是数值方法对热传导物理过程保守性的一种约束。
